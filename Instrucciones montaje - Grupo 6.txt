ğŸ“¦ Instrucciones para montar el ambiente de pruebas del sistema CSU_System

Este proyecto utiliza Docker y Docker Compose para facilitar su despliegue y ejecuciÃ³n en cualquier computadora.
No es necesario instalar Tomcat ni MySQL manualmente.

ğŸ§© Requisitos previos:
1. Tener instalado Docker y Docker Compose.
2. Clonar el repositorio del proyecto con `git clone` o copiar los archivos localmente.

ğŸ“ Estructura esperada del proyecto:
- docker-compose.yml (en la raÃ­z del proyecto)
- target/CSU_System.war (generado por `mvn clean install` dentro del subproyecto CSU_System)
- Subcarpeta `CSU_System/` con el cÃ³digo fuente y el archivo `pom.xml`.

âš™ï¸ Pasos para ejecutar el sistema:

1. Desde una terminal, posicionarse en la carpeta raÃ­z del proyecto (donde estÃ¡ `docker-compose.yml`).
2. Ejecutar el siguiente comando:

   docker-compose up --build

Este comando iniciarÃ¡:
- Un contenedor con MySQL 8.0 llamado `csu_mysql` con la base de datos `csu_system_db`
- Un contenedor con Tomcat 10.1 que desplegarÃ¡ automÃ¡ticamente el archivo `CSU_System.war`

ğŸ—‚ï¸ ConfiguraciÃ³n interna:
- La base de datos se conecta desde el contenedor web con estos datos:
  - Host: `csu_mysql`
  - Usuario: `user`
  - ContraseÃ±a: `pass`
  - Base de datos: `csu_system_db`
- Hibernate se encarga de generar las tablas automÃ¡ticamente al arrancar (gracias a `hibernate.hbm2ddl.auto = update`)

ğŸŒ Acceso al sistema:
Una vez levantado el entorno, el sistema estarÃ¡ disponible en:

http://localhost:8080/CSU_System/abm-test

âœ… Eso es todo. No se requiere ninguna configuraciÃ³n adicional.

ğŸ§ª Endpoints disponibles para pruebas (API REST)

La API estÃ¡ documentada con Swagger. AccedÃ© a:

http://localhost:8080/CSU_System/resources/swagger-ui/

ğŸ“ Endpoints de Barrios (/neighborhoods)

- GET    /neighborhoods             â†’ Listar todos los barrios
- GET    /neighborhoods/{id}        â†’ Obtener un barrio por ID
- POST   /neighborhoods             â†’ Crear un nuevo barrio (con coordenadas)
- PUT    /neighborhoods/{id}        â†’ Modificar un barrio
- DELETE /neighborhoods/{id}        â†’ Eliminar un barrio

ğŸ“ Endpoints de Zonas dentro de cada Barrio (/neighborhoods/{neighborhoodId}/zones)

- GET    /neighborhoods/{neighborhoodId}/zones  â†’ Listar zonas de un barrio
- GET    /neighborhoods/{neighborhoodId}/zones/{zoneId} â†’ Obtener una zona por ID dentro de un barrio
- POST   /neighborhoods/{neighborhoodId}/zones  â†’ Crear una zona dentro del barrio especificado
- PUT    /neighborhoods/{neighborhoodId}/zones/{zoneId} â†’ Modificar una zona dentro de un barrio
- DELETE /neighborhoods/{neighborhoodId}/zones/{zoneId} â†’ Eliminar una zona dentro de un barrio

ğŸ“ Endpoints de Encuestadores (/surveyors)

- GET    /surveyors             â†’ Listar todos los encuestadores
- GET    /surveyors/{id}        â†’ Obtener un encuestador por ID
- POST   /surveyors             â†’ Crear un nuevo encuestador
- PUT    /surveyors/{id}        â†’ Modificar un encuestador
- DELETE /surveyors/{id}        â†’ Eliminar un encuestador

ğŸ“ Endpoints de CampaÃ±as (/campaigns)

- GET    /campaigns             â†’ Listar todas las campaÃ±as
- GET    /campaigns/{id}        â†’ Obtener una campaÃ±a por ID
- POST   /campaigns             â†’ Crear una nueva campaÃ±a
- PUT    /campaigns/{id}        â†’ Modificar una campaÃ±a existente
- DELETE /campaigns/{id}        â†’ Eliminar una campaÃ±a

ğŸ“ Endpoints de Jornadas (/events)

- GET    /campaigns/{id}/events             â†’ Listar todas las jornadas
- GET    /campaigns/{id}/events/{id}        â†’ Obtener una jornada por ID
- POST   /campaigns/{id}/events             â†’ Crear una nueva jornada
- PUT    /campaigns/{id}/events/{id}        â†’ Modificar una jornada existente
- DELETE /campaigns/{id}/events/{id}        â†’ Eliminar una jornada

ğŸ“ Endpoints de encuestas (/campaigns/{campaignId}/survey)
- POST /campaigns/{id}/survey          â†’ Subir una encuesta nueva, pisando la anterior
- DELETE /campaigns/{id}/survey        â†’ Eliminar una encuesta

ğŸ“ Endpoints de organizaciones (/organizations)
- GET /organizations â†’ Listar todas las organizaciones
- GET /organizations/{id} â†’ Obtener una organizaciÃ³n por ID
- POST /organizations â†’ Crear una nueva organizaciÃ³n
- PUT /organizations/{id} â†’ Modificar una organizaciÃ³n existente
- DELETE /organizations/{id} â†’ Eliminar una organizaciÃ³n (borrado lÃ³gico, en cascada marca como eliminados a sus representantes)
- GET /organizations/{id}/representatives â†’ Listar los representantes asociados a esa organizaciÃ³n

ğŸ“ Endpoints de Usuarios por tipo:
- /admins
  - GET    /admins             â†’ Listar todos los administradores
  - GET    /admins/{id}        â†’ Obtener un administrador por ID
  - POST   /admins             â†’ Crear un nuevo administrador
  - PUT    /admins/{id}        â†’ Modificar un administrador
  - DELETE /admins/{id}        â†’ Eliminar un administrador

- /healthstaff
    - GET    /healthstaff        â†’ Listar todo el personal de salud
    - GET    /healthstaff/{id}   â†’ Obtener un miembro del personal de salud por ID
    - POST   /healthstaff        â†’ Crear un nuevo miembro del personal de salud
    - PUT    /healthstaff/{id}   â†’ Modificar un miembro del personal de salud
    - DELETE /healthstaff/{id}   â†’ Eliminar un miembro del personal de salud

- /representatives
    - GET    /representatives      â†’ Listar todos los representantes de organizaciones sociales
    - GET    /representatives/{id} â†’ Obtener un representante por ID
    - POST   /representatives      â†’ Crear un nuevo representante
    - PUT    /representatives/{id} â†’ Modificar un representante
    - DELETE /representatives/{id} â†’ Eliminar un representante

ğŸ“Œ Recomendaciones sobre el orden de creaciÃ³n de entidades

Para garantizar el correcto funcionamiento de la API REST y evitar errores de integridad referencial, se recomienda seguir el siguiente orden de creaciÃ³n de entidades basado en sus dependencias:

1ï¸âƒ£ Primero crear: Neighborhood
- Es base para zonas (`Zone`)
- TambiÃ©n es necesario para campaÃ±as (`Campaign`)
- Se crea con nombre, descripciÃ³n y coordenadas (las coordenadas se crean automÃ¡ticamente al crear el barrio)

2ï¸âƒ£ Luego: Zone
- Cada zona requiere el ID del barrio al que pertenece (`neighborhoodId`)
- Las coordenadas de la zona tambiÃ©n se cargan al momento de la creaciÃ³n

3ï¸âƒ£ Luego: Campaign
- Requiere el ID de un barrio existente (`neighborhoodId`)

4ï¸âƒ£ Luego: Surveyor
- No depende de otras entidades
- Puede crearse en cualquier momento

5ï¸âƒ£ Luego: Event
- Requiere:
  - ID de la zona (`zoneId`)
  - Lista de IDs de encuestadores (`surveyorsIds`)
  - Chequea que la campaÃ±a recibida por parÃ¡metro exista
- Por lo tanto, deben existir previamente zonas, encuestadores y campaÃ±as

6ï¸âƒ£ Usuarios:
- Admin y HealthStaff pueden crearse en cualquier momento, no dependen de ninguna otra entidad.
- Por ahora SocialOrgRepresentative se crean sin organizaciÃ³n asociada.

ğŸ“ Restricciones de unicidad y otras validaciones

El sistema impone las siguientes validaciones para mantener la integridad de los datos:

ğŸ”¹ Barrios (Neighborhood)
- No puede haber dos barrios con el mismo nombre

ğŸ”¹ Zonas (Zone)
- No puede haber dos zonas con el mismo nombre

ğŸ”¹ Usuarios (Admin, HealthStaff, SocialOrgRepresentative)
- No puede haber dos usuarios con el mismo email
- No puede haber dos HealthStaff con la misma matrÃ­cula

ğŸ”¹ Encuestadores (Surveyor)
- No puede haber dos encuestadores con el mismo DNI

ğŸ”¹ CampaÃ±as (Campaign)
- No puede haber dos campaÃ±as con el mismo nombre
- La fecha de inicio debe ser anterior a la fecha de fin

ğŸ”¹ Jornadas (Event)
- La fecha de la jornada debe estar dentro del rango de fechas de la campaÃ±a asociada
- No puede mandarse el mismo encuestador mÃ¡s de una vez en la misma jornada